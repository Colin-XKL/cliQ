# Cliq-Hub 站点开发计划

## 项目概览
Cliq-Hub是一个免费的cliqfile模板库站点，用户可以浏览、下载、贡献模板，并使用AI生成模板。

## 现有基础分析

### 现有技术栈
- **后端**: Go + Gin框架，已实现LLM模板生成API
- **前端**: Vue 3 + Vite，目前很基础
- **模板库**: 已有cliqfile包支持模板解析和验证
- **核心功能**: 通过LLM生成.cliqfile.yaml模板

### 现有功能缺口
- 模板库管理功能不完善
- 缺少用户系统
- 前端界面过于简单
- 没有模板预览和下载功能

## 总体开发方案

### 系统架构设计

#### 数据库设计
- **选型**: PostgreSQL（优先选型）
- **数据模型**:
  - 用户表（users） - 用户基础信息
  - 模板表（templates） - 模板主表，包含审核状态字段
  - 分类表（template_categories） - 模板分类
  - 贡献记录表（user_contributions） - 用户操作记录

#### API设计扩展
在现有API基础上方便扩展：
- **模板管理API**: 列表、详情、上传、下载
- **用户认证API**: 简单JWT认证，不做过多功能
- **AI生成API**: 积累现有生成功能

### 技术选型对齐原则

#### 前端技术栈
- **框架**: Vue 3 + Composition API（与现有项目保持一致）
- **UI库**: PrimeVue（优先使用项目现有组件库）
- **路由**: Vue Router 4
- **状态管理**: Pinia
- **HTTP客户端**: Axios

#### 后端技术栈
- **主要技术**: Go + Gin + PostgreSQL
- **认证机制**: JWT Token（简单实现）
- **存储方案**: 本地文件系统

### 核心功能模块

#### 主要功能模块
1. **模板库浏览**
   - 分类浏览和搜索
   - 模板预览和详情页面
   - 一键下载功能

2. **用户贡献系统**
   - 简单注册/登录功能
   - 模板上传（默认不审核，但保留审核字段）
   - 个人贡献记录

3. **AI模板生成**
   - 积累现有LLM生成功能
   - 在线生成界面
   - 生成结果编辑和保存

## 分阶段开发任务

### 第一阶段：基础架构搭建
**任务目标**: 搭建基础数据库和API框架

**实施内容**:
1. **数据库设计和初始化**
   - 设计PostgreSQL数据表结构
   - 创建数据库迁移脚本
   - 添加模板审核字段（默认不启用）

2. **后端API框架扩展**
   - 扩展现有Gin路由结构
   - 实现基础用户认证（JWT）
   - 实现模板列表和详情API

3. **前端基础框架搭建**
   - 搭建Vue 3 + PrimeVue项目结构
   - 配置Vue Router和Pinia
   - 实现基础路由和布局

### 第二阶段：核心功能实现
**任务目标**: 完成模板库的核心浏览功能

**实施内容**:
1. **模板浏览和搜索界面**
   - 实现模板列表页面
   - 实现分类浏览和搜索功能
   - 实现排序和分页功能

2. **模板详情和预览功能**
   - 实现模板详情页面
   - 实现YAML代码高亮显示
   - 实现模板预览功能

3. **模板下载功能**
   - 实现一键下载.cliqfile.yaml文件
   - 统计下载次数

### 第三阶段：用户系统和贡献功能
**任务目标**: 完成用户认证和模板贡献功能

**实施内容**:
1. **用户认证系统**
   - 实现简单注册/登录功能
   - 实现JWT Token管理
   - 实现用户个人信息管理

2. **模板上传功能**
   - 实现用户上传模板界面
   - 实现模板验证逻辑
   - 实现上传记录和管理

3. **个人中心功能**
   - 实现用户贡献记录查看
   - 实现个人模板管理

### 第四阶段：AI生成功能集成
**任务目标**: 集成现有的AI生成功能

**实施内容**:
1. **AI生成模板界面**
   - 集成现有LLM生成API
   - 实现在线生成界面
   - 实现生成结果预览

2. **生成结果编辑和保存**
   - 实现生成模板的编辑功能
   - 实现一键保存到模板库

### 第五阶段：优化和完善
**任务目标**: 优化性能和完善功能

**实施内容**:
1. **性能优化**
   - 实现模板搜索性能优化
   - 实现缓存机制
   - 优化前端加载速度

2. **安全性能优化**
   - 完善输入验证和安全检查
   - 实现API限流机制

3. **用户体验优化**
   - 优化界面交互
   - 完善错误提示和帮助文档

## 实现优势和重点

### 代码复用策略
- **优先使用现有组件**: 重用cliq-app中的PrimeVue组件
- **复用现有逻辑**: 重用现有的cliqfile包进行模板验证
- **积累现有API**: 直接使用现有的LLM生成功能

### 开发重点
- **核心功能优先**: 先完成模板浏览、下载、上传等核心功能
- **简单实现原则**: 用户认证等辅助功能保持简单
- **模板审核开关**: 保留审核字段，但默认不启用

### 关键文件列表

#### 需要修改的核心文件
**后端文件**:
- `apps/cliq-hub-backend/internal/http/router/router.go` - API路由扩展
- `apps/cliq-hub-backend/internal/http/handlers/generate_handler.go` - 模板管理处理器
- `apps/cliq-hub-backend/internal/template/model.go` - 数据模型扩展

**前端文件**:
- `apps/cliq-hub-frontend/src/App.vue` - 主应用组件重构
- `apps/cliq-hub-frontend/package.json` - 依赖管理

#### 需要新增的主要文件
- 数据库迁移脚本
- 用户认证相关组件
- 模板预览组件
- 模板管理页面组件
- 用户个人中心组件

## 风险控制策略
- **分步实施**: 每个阶段都有可交付的功能
- **优先核心功能**: 避免过度工程化
- **保留扩展性**: 模板审核字段为将来扩展做准备
- **与现有技术栈保持一致**: 减少学习成本和维护复杂度